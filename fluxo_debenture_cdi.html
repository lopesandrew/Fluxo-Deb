
<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Fluxo de Pagamento - Deb√™nture CDI+</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/3.9.1/chart.min.js"></script>
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            margin: 20px;
            background-color: #f5f5f5;
        }
        h1 {
            color: #2c3e50;
            text-align: center;
        }
        .container {
            max-width: 1400px;
            margin: 0 auto;
            background-color: white;
            padding: 30px;
            border-radius: 8px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        .input-summary {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 25px;
            border-radius: 8px;
            margin-bottom: 30px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.2);
        }
        .input-summary h2 {
            margin: 0 0 20px 0;
            font-size: 1.5em;
            border-bottom: 2px solid rgba(255,255,255,0.3);
            padding-bottom: 10px;
        }
        .input-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 15px;
            margin-top: 15px;
        }
        .input-item {
            background-color: rgba(255,255,255,0.1);
            padding: 12px;
            border-radius: 5px;
            border-left: 4px solid rgba(255,255,255,0.5);
        }
        .input-item label {
            display: block;
            font-size: 0.85em;
            opacity: 0.9;
            margin-bottom: 5px;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }
        .input-item .value {
            font-size: 1.3em;
            font-weight: bold;
        }
        table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 20px;
        }
        th {
            background-color: #34495e;
            color: white;
            padding: 12px;
            text-align: right;
            font-weight: 600;
            position: sticky;
            top: 0;
        }
        th:first-child {
            text-align: center;
        }
        td {
            padding: 10px;
            border-bottom: 1px solid #ddd;
            text-align: right;
        }
        td:first-child {
            text-align: center;
        }
        tr:hover {
            background-color: #f8f9fa;
        }
        .total-row {
            font-weight: bold;
            background-color: #ecf0f1;
        }
        .editable {
            background-color: #fff9e6;
            cursor: pointer;
        }
        .editable:hover {
            background-color: #fff3cd;
        }
        .summary {
            margin-top: 30px;
            padding: 20px;
            background-color: #e8f4f8;
            border-radius: 5px;
        }
        .summary h3 {
            margin-top: 0;
            color: #2c3e50;
            border-bottom: 2px solid #3498db;
            padding-bottom: 10px;
        }
        .summary-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin-top: 20px;
        }
        .metric-card {
            background-color: white;
            padding: 15px;
            border-radius: 5px;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
        }
        .metric-card h4 {
            margin: 0 0 10px 0;
            color: #34495e;
            font-size: 0.9em;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }
        .metric-value {
            font-size: 1.8em;
            font-weight: bold;
            color: #2980b9;
        }
        .metric-subtitle {
            font-size: 0.85em;
            color: #7f8c8d;
            margin-top: 5px;
        }
        canvas {
            background-color: white;
            border-radius: 5px;
            padding: 10px;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>üìä Fluxo de Pagamento - Deb√™nture CDI+</h1>

        <div class="input-summary">
            <h2>üìã Dados da Deb√™nture</h2>
            <div class="input-grid">
                <div class="input-item">
                    <label>üìÖ Data de Emiss√£o</label>
                    <div class="value">15/10/2025</div>
                </div>
                <div class="input-item">
                    <label>üìÖ Data de Vencimento</label>
                    <div class="value">15/10/2030</div>
                </div>
                <div class="input-item">
                    <label>üí∞ Valor Nominal (VNE)</label>
                    <div class="value">R$ 1,000.00</div>
                </div>
                <div class="input-item">
                    <label>üìä Taxa CDI Projetada</label>
                    <div class="value">15.00% a.a.</div>
                </div>
                <div class="input-item">
                    <label>‚ûï Spread sobre CDI</label>
                    <div class="value">1.00% a.a.</div>
                </div>
                <div class="input-item">
                    <label>üìà Taxa Total (Projetada)</label>
                    <div class="value">16.00% a.a.</div>
                </div>
                <div class="input-item">
                    <label>üíµ Periodicidade dos Juros</label>
                    <div class="value">Mensal</div>
                </div>
                <div class="input-item">
                    <label>üìâ Sistema de Amortiza√ß√£o</label>
                    <div class="value">SAC (Sistema de Amortiza√ß√£o Constante)</div>
                </div>
                <div class="input-item">
                    <label>‚è≥ Car√™ncia do Principal</label>
                    <div class="value">24 meses</div>
                </div>
                <div class="input-item">
                    <label>üìÜ Prazo Total</label>
                    <div class="value">1826 dias</div>
                </div>
            </div>
        </div>

        <table id="cashFlowTable">
            <thead>
                <tr>
                    <th>Evento</th>
                    <th>Data</th>
                    <th>Dias √öteis</th>
                    <th>Dias Corridos</th>
                    <th>Saldo Devedor (R$)</th>
                    <th>Juros (R$)</th>
                    <th>Amortiza√ß√£o (R$)</th>
                    <th>PMT (R$)</th>
                </tr>
            </thead>
            <tbody>

                <tr>
                    <td>1</td>
                    <td>17/11/2025</td>
                    <td>23</td>
                    <td>33</td>
                    <td>R$ 1,000.00</td>
                    <td class="editable">R$ 13.76</td>
                    <td class="editable">R$ 0.00</td>
                    <td><strong>R$ 13.76</strong></td>
                </tr>

                <tr>
                    <td>2</td>
                    <td>15/12/2025</td>
                    <td>19</td>
                    <td>28</td>
                    <td>R$ 1,000.00</td>
                    <td class="editable">R$ 11.35</td>
                    <td class="editable">R$ 0.00</td>
                    <td><strong>R$ 11.35</strong></td>
                </tr>

                <tr>
                    <td>3</td>
                    <td>15/01/2026</td>
                    <td>21</td>
                    <td>31</td>
                    <td>R$ 1,000.00</td>
                    <td class="editable">R$ 12.55</td>
                    <td class="editable">R$ 0.00</td>
                    <td><strong>R$ 12.55</strong></td>
                </tr>

                <tr>
                    <td>4</td>
                    <td>16/02/2026</td>
                    <td>22</td>
                    <td>32</td>
                    <td>R$ 1,000.00</td>
                    <td class="editable">R$ 13.16</td>
                    <td class="editable">R$ 0.00</td>
                    <td><strong>R$ 13.16</strong></td>
                </tr>

                <tr>
                    <td>5</td>
                    <td>16/03/2026</td>
                    <td>20</td>
                    <td>28</td>
                    <td>R$ 1,000.00</td>
                    <td class="editable">R$ 11.95</td>
                    <td class="editable">R$ 0.00</td>
                    <td><strong>R$ 11.95</strong></td>
                </tr>

                <tr>
                    <td>6</td>
                    <td>15/04/2026</td>
                    <td>21</td>
                    <td>30</td>
                    <td>R$ 1,000.00</td>
                    <td class="editable">R$ 12.55</td>
                    <td class="editable">R$ 0.00</td>
                    <td><strong>R$ 12.55</strong></td>
                </tr>

                <tr>
                    <td>7</td>
                    <td>15/05/2026</td>
                    <td>20</td>
                    <td>30</td>
                    <td>R$ 1,000.00</td>
                    <td class="editable">R$ 11.95</td>
                    <td class="editable">R$ 0.00</td>
                    <td><strong>R$ 11.95</strong></td>
                </tr>

                <tr>
                    <td>8</td>
                    <td>15/06/2026</td>
                    <td>21</td>
                    <td>31</td>
                    <td>R$ 1,000.00</td>
                    <td class="editable">R$ 12.55</td>
                    <td class="editable">R$ 0.00</td>
                    <td><strong>R$ 12.55</strong></td>
                </tr>

                <tr>
                    <td>9</td>
                    <td>15/07/2026</td>
                    <td>22</td>
                    <td>30</td>
                    <td>R$ 1,000.00</td>
                    <td class="editable">R$ 13.16</td>
                    <td class="editable">R$ 0.00</td>
                    <td><strong>R$ 13.16</strong></td>
                </tr>

                <tr>
                    <td>10</td>
                    <td>17/08/2026</td>
                    <td>23</td>
                    <td>33</td>
                    <td>R$ 1,000.00</td>
                    <td class="editable">R$ 13.76</td>
                    <td class="editable">R$ 0.00</td>
                    <td><strong>R$ 13.76</strong></td>
                </tr>

                <tr>
                    <td>11</td>
                    <td>15/09/2026</td>
                    <td>20</td>
                    <td>29</td>
                    <td>R$ 1,000.00</td>
                    <td class="editable">R$ 11.95</td>
                    <td class="editable">R$ 0.00</td>
                    <td><strong>R$ 11.95</strong></td>
                </tr>

                <tr>
                    <td>12</td>
                    <td>15/10/2026</td>
                    <td>21</td>
                    <td>30</td>
                    <td>R$ 1,000.00</td>
                    <td class="editable">R$ 12.55</td>
                    <td class="editable">R$ 0.00</td>
                    <td><strong>R$ 12.55</strong></td>
                </tr>

                <tr>
                    <td>13</td>
                    <td>16/11/2026</td>
                    <td>21</td>
                    <td>32</td>
                    <td>R$ 1,000.00</td>
                    <td class="editable">R$ 12.55</td>
                    <td class="editable">R$ 0.00</td>
                    <td><strong>R$ 12.55</strong></td>
                </tr>

                <tr>
                    <td>14</td>
                    <td>15/12/2026</td>
                    <td>20</td>
                    <td>29</td>
                    <td>R$ 1,000.00</td>
                    <td class="editable">R$ 11.95</td>
                    <td class="editable">R$ 0.00</td>
                    <td><strong>R$ 11.95</strong></td>
                </tr>

                <tr>
                    <td>15</td>
                    <td>15/01/2027</td>
                    <td>21</td>
                    <td>31</td>
                    <td>R$ 1,000.00</td>
                    <td class="editable">R$ 12.55</td>
                    <td class="editable">R$ 0.00</td>
                    <td><strong>R$ 12.55</strong></td>
                </tr>

                <tr>
                    <td>16</td>
                    <td>15/02/2027</td>
                    <td>21</td>
                    <td>31</td>
                    <td>R$ 1,000.00</td>
                    <td class="editable">R$ 12.55</td>
                    <td class="editable">R$ 0.00</td>
                    <td><strong>R$ 12.55</strong></td>
                </tr>

                <tr>
                    <td>17</td>
                    <td>15/03/2027</td>
                    <td>20</td>
                    <td>28</td>
                    <td>R$ 1,000.00</td>
                    <td class="editable">R$ 11.95</td>
                    <td class="editable">R$ 0.00</td>
                    <td><strong>R$ 11.95</strong></td>
                </tr>

                <tr>
                    <td>18</td>
                    <td>15/04/2027</td>
                    <td>22</td>
                    <td>31</td>
                    <td>R$ 1,000.00</td>
                    <td class="editable">R$ 13.16</td>
                    <td class="editable">R$ 0.00</td>
                    <td><strong>R$ 13.16</strong></td>
                </tr>

                <tr>
                    <td>19</td>
                    <td>17/05/2027</td>
                    <td>21</td>
                    <td>32</td>
                    <td>R$ 1,000.00</td>
                    <td class="editable">R$ 12.55</td>
                    <td class="editable">R$ 0.00</td>
                    <td><strong>R$ 12.55</strong></td>
                </tr>

                <tr>
                    <td>20</td>
                    <td>15/06/2027</td>
                    <td>21</td>
                    <td>29</td>
                    <td>R$ 1,000.00</td>
                    <td class="editable">R$ 12.55</td>
                    <td class="editable">R$ 0.00</td>
                    <td><strong>R$ 12.55</strong></td>
                </tr>

                <tr>
                    <td>21</td>
                    <td>15/07/2027</td>
                    <td>22</td>
                    <td>30</td>
                    <td>R$ 1,000.00</td>
                    <td class="editable">R$ 13.16</td>
                    <td class="editable">R$ 0.00</td>
                    <td><strong>R$ 13.16</strong></td>
                </tr>

                <tr>
                    <td>22</td>
                    <td>16/08/2027</td>
                    <td>22</td>
                    <td>32</td>
                    <td>R$ 1,000.00</td>
                    <td class="editable">R$ 13.16</td>
                    <td class="editable">R$ 0.00</td>
                    <td><strong>R$ 13.16</strong></td>
                </tr>

                <tr>
                    <td>23</td>
                    <td>15/09/2027</td>
                    <td>21</td>
                    <td>30</td>
                    <td>R$ 1,000.00</td>
                    <td class="editable">R$ 12.55</td>
                    <td class="editable">R$ 0.00</td>
                    <td><strong>R$ 12.55</strong></td>
                </tr>

                <tr>
                    <td>24</td>
                    <td>15/10/2027</td>
                    <td>21</td>
                    <td>30</td>
                    <td>R$ 1,000.00</td>
                    <td class="editable">R$ 12.55</td>
                    <td class="editable">R$ 0.00</td>
                    <td><strong>R$ 12.55</strong></td>
                </tr>

                <tr>
                    <td>25</td>
                    <td>16/11/2027</td>
                    <td>20</td>
                    <td>32</td>
                    <td>R$ 1,000.00</td>
                    <td class="editable">R$ 11.95</td>
                    <td class="editable">R$ 27.78</td>
                    <td><strong>R$ 39.73</strong></td>
                </tr>

                <tr>
                    <td>26</td>
                    <td>15/12/2027</td>
                    <td>21</td>
                    <td>29</td>
                    <td>R$ 972.22</td>
                    <td class="editable">R$ 12.21</td>
                    <td class="editable">R$ 27.78</td>
                    <td><strong>R$ 39.98</strong></td>
                </tr>

                <tr>
                    <td>27</td>
                    <td>17/01/2028</td>
                    <td>23</td>
                    <td>33</td>
                    <td>R$ 944.44</td>
                    <td class="editable">R$ 12.99</td>
                    <td class="editable">R$ 27.78</td>
                    <td><strong>R$ 40.77</strong></td>
                </tr>

                <tr>
                    <td>28</td>
                    <td>15/02/2028</td>
                    <td>21</td>
                    <td>29</td>
                    <td>R$ 916.67</td>
                    <td class="editable">R$ 11.51</td>
                    <td class="editable">R$ 27.78</td>
                    <td><strong>R$ 39.29</strong></td>
                </tr>

                <tr>
                    <td>29</td>
                    <td>15/03/2028</td>
                    <td>21</td>
                    <td>29</td>
                    <td>R$ 888.89</td>
                    <td class="editable">R$ 11.16</td>
                    <td class="editable">R$ 27.78</td>
                    <td><strong>R$ 38.94</strong></td>
                </tr>

                <tr>
                    <td>30</td>
                    <td>17/04/2028</td>
                    <td>22</td>
                    <td>33</td>
                    <td>R$ 861.11</td>
                    <td class="editable">R$ 11.33</td>
                    <td class="editable">R$ 27.78</td>
                    <td><strong>R$ 39.11</strong></td>
                </tr>

                <tr>
                    <td>31</td>
                    <td>15/05/2028</td>
                    <td>18</td>
                    <td>28</td>
                    <td>R$ 833.33</td>
                    <td class="editable">R$ 8.96</td>
                    <td class="editable">R$ 27.78</td>
                    <td><strong>R$ 36.74</strong></td>
                </tr>

                <tr>
                    <td>32</td>
                    <td>15/06/2028</td>
                    <td>23</td>
                    <td>31</td>
                    <td>R$ 805.56</td>
                    <td class="editable">R$ 11.08</td>
                    <td class="editable">R$ 27.78</td>
                    <td><strong>R$ 38.86</strong></td>
                </tr>

                <tr>
                    <td>33</td>
                    <td>17/07/2028</td>
                    <td>22</td>
                    <td>32</td>
                    <td>R$ 777.78</td>
                    <td class="editable">R$ 10.23</td>
                    <td class="editable">R$ 27.78</td>
                    <td><strong>R$ 38.01</strong></td>
                </tr>

                <tr>
                    <td>34</td>
                    <td>15/08/2028</td>
                    <td>21</td>
                    <td>29</td>
                    <td>R$ 750.00</td>
                    <td class="editable">R$ 9.42</td>
                    <td class="editable">R$ 27.78</td>
                    <td><strong>R$ 37.19</strong></td>
                </tr>

                <tr>
                    <td>35</td>
                    <td>15/09/2028</td>
                    <td>22</td>
                    <td>31</td>
                    <td>R$ 722.22</td>
                    <td class="editable">R$ 9.50</td>
                    <td class="editable">R$ 27.78</td>
                    <td><strong>R$ 37.28</strong></td>
                </tr>

                <tr>
                    <td>36</td>
                    <td>16/10/2028</td>
                    <td>20</td>
                    <td>31</td>
                    <td>R$ 694.44</td>
                    <td class="editable">R$ 8.30</td>
                    <td class="editable">R$ 27.78</td>
                    <td><strong>R$ 36.08</strong></td>
                </tr>

                <tr>
                    <td>37</td>
                    <td>16/11/2028</td>
                    <td>21</td>
                    <td>31</td>
                    <td>R$ 666.67</td>
                    <td class="editable">R$ 8.37</td>
                    <td class="editable">R$ 27.78</td>
                    <td><strong>R$ 36.15</strong></td>
                </tr>

                <tr>
                    <td>38</td>
                    <td>15/12/2028</td>
                    <td>20</td>
                    <td>29</td>
                    <td>R$ 638.89</td>
                    <td class="editable">R$ 7.64</td>
                    <td class="editable">R$ 27.78</td>
                    <td><strong>R$ 35.41</strong></td>
                </tr>

                <tr>
                    <td>39</td>
                    <td>15/01/2029</td>
                    <td>19</td>
                    <td>31</td>
                    <td>R$ 611.11</td>
                    <td class="editable">R$ 6.94</td>
                    <td class="editable">R$ 27.78</td>
                    <td><strong>R$ 34.71</strong></td>
                </tr>

                <tr>
                    <td>40</td>
                    <td>15/02/2029</td>
                    <td>23</td>
                    <td>31</td>
                    <td>R$ 583.33</td>
                    <td class="editable">R$ 8.03</td>
                    <td class="editable">R$ 27.78</td>
                    <td><strong>R$ 35.80</strong></td>
                </tr>

                <tr>
                    <td>41</td>
                    <td>15/03/2029</td>
                    <td>20</td>
                    <td>28</td>
                    <td>R$ 555.56</td>
                    <td class="editable">R$ 6.64</td>
                    <td class="editable">R$ 27.78</td>
                    <td><strong>R$ 34.42</strong></td>
                </tr>

                <tr>
                    <td>42</td>
                    <td>16/04/2029</td>
                    <td>21</td>
                    <td>32</td>
                    <td>R$ 527.78</td>
                    <td class="editable">R$ 6.63</td>
                    <td class="editable">R$ 27.78</td>
                    <td><strong>R$ 34.40</strong></td>
                </tr>

                <tr>
                    <td>43</td>
                    <td>15/05/2029</td>
                    <td>20</td>
                    <td>29</td>
                    <td>R$ 500.00</td>
                    <td class="editable">R$ 5.98</td>
                    <td class="editable">R$ 27.78</td>
                    <td><strong>R$ 33.75</strong></td>
                </tr>

                <tr>
                    <td>44</td>
                    <td>15/06/2029</td>
                    <td>23</td>
                    <td>31</td>
                    <td>R$ 472.22</td>
                    <td class="editable">R$ 6.50</td>
                    <td class="editable">R$ 27.78</td>
                    <td><strong>R$ 34.27</strong></td>
                </tr>

                <tr>
                    <td>45</td>
                    <td>16/07/2029</td>
                    <td>21</td>
                    <td>31</td>
                    <td>R$ 444.44</td>
                    <td class="editable">R$ 5.58</td>
                    <td class="editable">R$ 27.78</td>
                    <td><strong>R$ 33.36</strong></td>
                </tr>

                <tr>
                    <td>46</td>
                    <td>15/08/2029</td>
                    <td>22</td>
                    <td>30</td>
                    <td>R$ 416.67</td>
                    <td class="editable">R$ 5.48</td>
                    <td class="editable">R$ 27.78</td>
                    <td><strong>R$ 33.26</strong></td>
                </tr>

                <tr>
                    <td>47</td>
                    <td>17/09/2029</td>
                    <td>22</td>
                    <td>33</td>
                    <td>R$ 388.89</td>
                    <td class="editable">R$ 5.12</td>
                    <td class="editable">R$ 27.78</td>
                    <td><strong>R$ 32.89</strong></td>
                </tr>

                <tr>
                    <td>48</td>
                    <td>15/10/2029</td>
                    <td>19</td>
                    <td>28</td>
                    <td>R$ 361.11</td>
                    <td class="editable">R$ 4.10</td>
                    <td class="editable">R$ 27.78</td>
                    <td><strong>R$ 31.88</strong></td>
                </tr>

                <tr>
                    <td>49</td>
                    <td>16/11/2029</td>
                    <td>22</td>
                    <td>32</td>
                    <td>R$ 333.33</td>
                    <td class="editable">R$ 4.39</td>
                    <td class="editable">R$ 27.78</td>
                    <td><strong>R$ 32.16</strong></td>
                </tr>

                <tr>
                    <td>50</td>
                    <td>17/12/2029</td>
                    <td>20</td>
                    <td>31</td>
                    <td>R$ 305.56</td>
                    <td class="editable">R$ 3.65</td>
                    <td class="editable">R$ 27.78</td>
                    <td><strong>R$ 31.43</strong></td>
                </tr>

                <tr>
                    <td>51</td>
                    <td>15/01/2030</td>
                    <td>19</td>
                    <td>29</td>
                    <td>R$ 277.78</td>
                    <td class="editable">R$ 3.15</td>
                    <td class="editable">R$ 27.78</td>
                    <td><strong>R$ 30.93</strong></td>
                </tr>

                <tr>
                    <td>52</td>
                    <td>15/02/2030</td>
                    <td>23</td>
                    <td>31</td>
                    <td>R$ 250.00</td>
                    <td class="editable">R$ 3.44</td>
                    <td class="editable">R$ 27.78</td>
                    <td><strong>R$ 31.22</strong></td>
                </tr>

                <tr>
                    <td>53</td>
                    <td>15/03/2030</td>
                    <td>20</td>
                    <td>28</td>
                    <td>R$ 222.22</td>
                    <td class="editable">R$ 2.66</td>
                    <td class="editable">R$ 27.78</td>
                    <td><strong>R$ 30.43</strong></td>
                </tr>

                <tr>
                    <td>54</td>
                    <td>15/04/2030</td>
                    <td>21</td>
                    <td>31</td>
                    <td>R$ 194.44</td>
                    <td class="editable">R$ 2.44</td>
                    <td class="editable">R$ 27.78</td>
                    <td><strong>R$ 30.22</strong></td>
                </tr>

                <tr>
                    <td>55</td>
                    <td>15/05/2030</td>
                    <td>20</td>
                    <td>30</td>
                    <td>R$ 166.67</td>
                    <td class="editable">R$ 1.99</td>
                    <td class="editable">R$ 27.78</td>
                    <td><strong>R$ 29.77</strong></td>
                </tr>

                <tr>
                    <td>56</td>
                    <td>17/06/2030</td>
                    <td>23</td>
                    <td>33</td>
                    <td>R$ 138.89</td>
                    <td class="editable">R$ 1.91</td>
                    <td class="editable">R$ 27.78</td>
                    <td><strong>R$ 29.69</strong></td>
                </tr>

                <tr>
                    <td>57</td>
                    <td>15/07/2030</td>
                    <td>20</td>
                    <td>28</td>
                    <td>R$ 111.11</td>
                    <td class="editable">R$ 1.33</td>
                    <td class="editable">R$ 27.78</td>
                    <td><strong>R$ 29.11</strong></td>
                </tr>

                <tr>
                    <td>58</td>
                    <td>15/08/2030</td>
                    <td>23</td>
                    <td>31</td>
                    <td>R$ 83.33</td>
                    <td class="editable">R$ 1.15</td>
                    <td class="editable">R$ 27.78</td>
                    <td><strong>R$ 28.92</strong></td>
                </tr>

                <tr>
                    <td>59</td>
                    <td>16/09/2030</td>
                    <td>22</td>
                    <td>32</td>
                    <td>R$ 55.56</td>
                    <td class="editable">R$ 0.73</td>
                    <td class="editable">R$ 27.78</td>
                    <td><strong>R$ 28.51</strong></td>
                </tr>

                <tr>
                    <td>60</td>
                    <td>15/10/2030</td>
                    <td>21</td>
                    <td>29</td>
                    <td>R$ 27.78</td>
                    <td class="editable">R$ 0.35</td>
                    <td class="editable">R$ 27.78</td>
                    <td><strong>R$ 28.13</strong></td>
                </tr>

                <tr class="total-row">
                    <td colspan="5">TOTAIS</td>
                    <td>R$ 535.32</td>
                    <td>R$ 1,000.00</td>
                    <td><strong>R$ 1,535.32</strong></td>
                </tr>

            </tbody>
        </table>
        
        <div class="summary">
            <h3>üìä Resumo e M√©tricas Financeiras</h3>
            
            <div class="summary-grid">
                <div class="metric-card">
                    <h4>üí∞ Total de Juros Pagos</h4>
                    <div class="metric-value" id="totalJuros">R$ 535.32</div>
                    <div class="metric-subtitle">Remunera√ß√£o CDI + Spread</div>
                </div>
                
                <div class="metric-card">
                    <h4>üíµ Total de Amortiza√ß√£o</h4>
                    <div class="metric-value" id="totalAmort">R$ 1,000.00</div>
                    <div class="metric-subtitle">Principal devolvido</div>
                </div>
                
                <div class="metric-card">
                    <h4>üí≥ Total Pago (PMT)</h4>
                    <div class="metric-value" id="totalPmt">R$ 1,535.32</div>
                    <div class="metric-subtitle">Juros + Amortiza√ß√£o</div>
                </div>
                
                <div class="metric-card">
                    <h4>üìÖ N√∫mero de Pagamentos</h4>
                    <div class="metric-value">60</div>
                    <div class="metric-subtitle">Total de eventos</div>
                </div>
                
                <div class="metric-card">
                    <h4>üí∏ PMT M√©dio</h4>
                    <div class="metric-value">R$ 25.59</div>
                    <div class="metric-subtitle">M√©dia dos pagamentos</div>
                </div>
                
                <div class="metric-card">
                    <h4>‚è±Ô∏è Prazo M√©dio</h4>
                    <div class="metric-value">2.98 anos</div>
                    <div class="metric-subtitle">35.7 meses ponderados</div>
                </div>
                
                <div class="metric-card">
                    <h4>üìê Duration (Macaulay)</h4>
                    <div class="metric-value">2.73 anos</div>
                    <div class="metric-subtitle">32.8 meses | Sensibilidade ao tempo</div>
                </div>
                
                <div class="metric-card">
                    <h4>üìâ Modified Duration</h4>
                    <div class="metric-value">2.36</div>
                    <div class="metric-subtitle">Sensibilidade √† taxa de juros</div>
                </div>
                
                <div class="metric-card">
                    <h4>üìà TIR (Taxa Interna de Retorno)</h4>
                    <div class="metric-value">1.26%</div>
                    <div class="metric-subtitle">Retorno anual equivalente</div>
                </div>
                
                <div class="metric-card">
                    <h4>‚è≥ Payback Simples</h4>
                    <div class="metric-value">3.58 anos</div>
                    <div class="metric-subtitle">43.0 meses</div>
                </div>
                
                <div class="metric-card">
                    <h4>üíπ Payback Descontado</h4>
                    <div class="metric-value">5.00 anos</div>
                    <div class="metric-subtitle">60.0 meses (VP)</div>
                </div>
            </div>
        </div>
        
        <div class="summary">
            <h3>üìä Visualiza√ß√£o do Fluxo de Caixa</h3>
            <canvas id="cashFlowChart" style="max-height: 400px;"></canvas>
        </div>
        
        <p style="margin-top: 30px; text-align: center; color: #7f8c8d; font-size: 0.9em;">
            Calculado conforme padr√µes B3/ANBIMA - Base 252 dias √∫teis<br>
            C√©lulas em amarelo s√£o edit√°veis (clique para editar)<br><br>
            <strong>üìö Gloss√°rio:</strong><br>
            <strong>TIR:</strong> Taxa que iguala o valor presente dos fluxos futuros ao investimento inicial<br>
            <strong>Payback Simples:</strong> Tempo para recuperar o investimento (sem considerar valor do dinheiro no tempo)<br>
            <strong>Payback Descontado:</strong> Tempo para recuperar o investimento considerando o valor presente dos fluxos<br>
            <strong>Duration:</strong> Prazo m√©dio ponderado dos fluxos de caixa<br>
            <strong>Modified Duration:</strong> Sensibilidade do pre√ßo √† varia√ß√£o de 1% na taxa de juros
        </p>
    </div>
    
    <script>
        // Torna c√©lulas edit√°veis
        document.querySelectorAll('.editable').forEach(cell => {
            cell.addEventListener('click', function() {
                const currentValue = this.textContent.replace('R$ ', '').replace(/\./g, '').replace(',', '.');
                const input = document.createElement('input');
                input.type = 'text';
                input.value = currentValue;
                input.style.width = '100%';
                input.style.textAlign = 'right';
                
                this.textContent = '';
                this.appendChild(input);
                input.focus();
                
                input.addEventListener('blur', function() {
                    const newValue = parseFloat(this.value);
                    if (!isNaN(newValue)) {
                        cell.textContent = 'R$ ' + newValue.toLocaleString('pt-BR', {minimumFractionDigits: 2, maximumFractionDigits: 2});
                        updateTotals();
                    } else {
                        cell.textContent = 'R$ ' + currentValue;
                    }
                });
                
                input.addEventListener('keypress', function(e) {
                    if (e.key === 'Enter') {
                        this.blur();
                    }
                });
            });
        });
        
        function updateTotals() {
            const rows = document.querySelectorAll('#cashFlowTable tbody tr:not(.total-row)');
            let totalJuros = 0;
            let totalAmort = 0;
            let totalPmt = 0;
            
            rows.forEach(row => {
                const cells = row.querySelectorAll('td');
                const juros = parseFloat(cells[5].textContent.replace('R$ ', '').replace(/\./g, '').replace(',', '.'));
                const amort = parseFloat(cells[6].textContent.replace('R$ ', '').replace(/\./g, '').replace(',', '.'));
                const pmt = juros + amort;
                
                totalJuros += juros;
                totalAmort += amort;
                totalPmt += pmt;
                
                cells[7].innerHTML = '<strong>R$ ' + pmt.toLocaleString('pt-BR', {minimumFractionDigits: 2, maximumFractionDigits: 2}) + '</strong>';
            });
            
            const numPayments = rows.length;
            const avgPmt = totalPmt / numPayments;
            
            // Atualiza linha de totais
            const totalRow = document.querySelector('.total-row');
            totalRow.cells[1].textContent = 'R$ ' + totalJuros.toLocaleString('pt-BR', {minimumFractionDigits: 2, maximumFractionDigits: 2});
            totalRow.cells[2].textContent = 'R$ ' + totalAmort.toLocaleString('pt-BR', {minimumFractionDigits: 2, maximumFractionDigits: 2});
            totalRow.cells[3].innerHTML = '<strong>R$ ' + totalPmt.toLocaleString('pt-BR', {minimumFractionDigits: 2, maximumFractionDigits: 2}) + '</strong>';
            
            // Atualiza cards de resumo
            document.getElementById('totalJuros').textContent = 'R$ ' + totalJuros.toLocaleString('pt-BR', {minimumFractionDigits: 2, maximumFractionDigits: 2});
            document.getElementById('totalAmort').textContent = 'R$ ' + totalAmort.toLocaleString('pt-BR', {minimumFractionDigits: 2, maximumFractionDigits: 2});
            document.getElementById('totalPmt').textContent = 'R$ ' + totalPmt.toLocaleString('pt-BR', {minimumFractionDigits: 2, maximumFractionDigits: 2});
            
            // Atualiza PMT m√©dio
            const avgPmtElements = document.querySelectorAll('.metric-value');
            avgPmtElements[4].textContent = 'R$ ' + avgPmt.toLocaleString('pt-BR', {minimumFractionDigits: 2, maximumFractionDigits: 2});
        }
        
        // Cria gr√°fico do fluxo de caixa
        const ctx = document.getElementById('cashFlowChart').getContext('2d');
        const chartData = {
            labels: ['17/11/2025', '15/12/2025', '15/01/2026', '16/02/2026', '16/03/2026', '15/04/2026', '15/05/2026', '15/06/2026', '15/07/2026', '17/08/2026', '15/09/2026', '15/10/2026', '16/11/2026', '15/12/2026', '15/01/2027', '15/02/2027', '15/03/2027', '15/04/2027', '17/05/2027', '15/06/2027', '15/07/2027', '16/08/2027', '15/09/2027', '15/10/2027', '16/11/2027', '15/12/2027', '17/01/2028', '15/02/2028', '15/03/2028', '17/04/2028', '15/05/2028', '15/06/2028', '17/07/2028', '15/08/2028', '15/09/2028', '16/10/2028', '16/11/2028', '15/12/2028', '15/01/2029', '15/02/2029', '15/03/2029', '16/04/2029', '15/05/2029', '15/06/2029', '16/07/2029', '15/08/2029', '17/09/2029', '15/10/2029', '16/11/2029', '17/12/2029', '15/01/2030', '15/02/2030', '15/03/2030', '15/04/2030', '15/05/2030', '17/06/2030', '15/07/2030', '15/08/2030', '16/09/2030', '15/10/2030'],
            datasets: [
                {
                    label: 'Juros (R$)',
                    data: [13.76, 11.35, 12.55, 13.16, 11.95, 12.55, 11.95, 12.55, 13.16, 13.76, 11.95, 12.55, 12.55, 11.95, 12.55, 12.55, 11.95, 13.16, 12.55, 12.55, 13.16, 13.16, 12.55, 12.55, 11.95, 12.21, 12.99, 11.51, 11.16, 11.33, 8.96, 11.08, 10.23, 9.42, 9.50, 8.30, 8.37, 7.64, 6.94, 8.03, 6.64, 6.63, 5.98, 6.50, 5.58, 5.48, 5.12, 4.10, 4.39, 3.65, 3.15, 3.44, 2.66, 2.44, 1.99, 1.91, 1.33, 1.15, 0.73, 0.35],
                    backgroundColor: 'rgba(52, 152, 219, 0.6)',
                    borderColor: 'rgba(52, 152, 219, 1)',
                    borderWidth: 1
                },
                {
                    label: 'Amortiza√ß√£o (R$)',
                    data: [0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 27.78, 27.78, 27.78, 27.78, 27.78, 27.78, 27.78, 27.78, 27.78, 27.78, 27.78, 27.78, 27.78, 27.78, 27.78, 27.78, 27.78, 27.78, 27.78, 27.78, 27.78, 27.78, 27.78, 27.78, 27.78, 27.78, 27.78, 27.78, 27.78, 27.78, 27.78, 27.78, 27.78, 27.78, 27.78, 27.78],
                    backgroundColor: 'rgba(46, 204, 113, 0.6)',
                    borderColor: 'rgba(46, 204, 113, 1)',
                    borderWidth: 1
                },
                {
                    label: 'PMT Total (R$)',
                    data: [13.76, 11.35, 12.55, 13.16, 11.95, 12.55, 11.95, 12.55, 13.16, 13.76, 11.95, 12.55, 12.55, 11.95, 12.55, 12.55, 11.95, 13.16, 12.55, 12.55, 13.16, 13.16, 12.55, 12.55, 39.73, 39.98, 40.77, 39.29, 38.94, 39.11, 36.74, 38.86, 38.01, 37.19, 37.28, 36.08, 36.15, 35.41, 34.71, 35.80, 34.42, 34.40, 33.75, 34.27, 33.36, 33.26, 32.89, 31.88, 32.16, 31.43, 30.93, 31.22, 30.43, 30.22, 29.77, 29.69, 29.11, 28.92, 28.51, 28.13],
                    type: 'line',
                    backgroundColor: 'rgba(231, 76, 60, 0.2)',
                    borderColor: 'rgba(231, 76, 60, 1)',
                    borderWidth: 2,
                    fill: false,
                    tension: 0.1,
                    pointRadius: 4,
                    pointHoverRadius: 6
                }
            ]
        };
        
        const config = {
            type: 'bar',
            data: chartData,
            options: {
                responsive: true,
                maintainAspectRatio: true,
                plugins: {
                    title: {
                        display: true,
                        text: 'Fluxo de Pagamentos ao Longo do Tempo',
                        font: {
                            size: 16,
                            weight: 'bold'
                        }
                    },
                    legend: {
                        display: true,
                        position: 'top',
                    },
                    tooltip: {
                        mode: 'index',
                        intersect: false,
                        callbacks: {
                            label: function(context) {
                                let label = context.dataset.label || '';
                                if (label) {
                                    label += ': ';
                                }
                                label += 'R$ ' + context.parsed.y.toLocaleString('pt-BR', {minimumFractionDigits: 2, maximumFractionDigits: 2});
                                return label;
                            }
                        }
                    }
                },
                scales: {
                    x: {
                        stacked: true,
                        title: {
                            display: true,
                            text: 'Data de Pagamento'
                        },
                        ticks: {
                            maxRotation: 45,
                            minRotation: 45,
                            autoSkip: true,
                            maxTicksLimit: 20
                        }
                    },
                    y: {
                        stacked: true,
                        title: {
                            display: true,
                            text: 'Valor (R$)'
                        },
                        ticks: {
                            callback: function(value) {
                                return 'R$ ' + value.toLocaleString('pt-BR', {minimumFractionDigits: 0, maximumFractionDigits: 0});
                            }
                        }
                    }
                }
            }
        };
        
        const cashFlowChart = new Chart(ctx, config);
    </script>
</body>
</html>
